<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Social Engineering Dashboard</title>

<!-- Fonts & Libraries -->
<link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Roboto+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Rajdhani', sans-serif; background: #1a1d35; color: #fff; }
.container { max-width: 1200px; margin: 0 auto; padding: 20px; }
header { text-align: center; margin-bottom: 30px; }
h1 { font-size: 2.5rem; letter-spacing: 3px; }
.subtitle { color: #8b95a5; margin-top: 10px; }
.upload-section { background: #22253a; padding: 30px; border-radius: 12px; margin-bottom: 30px; }
.upload-area { border: 3px dashed #2962FF; padding: 40px 20px; text-align: center; cursor: pointer; border-radius: 12px; background: rgba(41,98,255,0.05); }
.upload-area:hover { border-color: #4CAF50; background: rgba(76,175,80,0.1); }
.file-input { display: none; }
.file-info { margin-top: 15px; color: #27ae60; }
.error-msg { margin-top: 15px; color: #e74c3c; }
.table-container { background: #22253a; padding: 30px; border-radius: 12px; display: none; }
table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
th, td { padding: 12px 15px; border-bottom: 1px solid #2c2f4d; }
th { background: #1a1d35; font-weight: 600; color: #a8b2c1; }
tr:hover { background: rgba(41,98,255,0.05); }
.screenshot-thumbnail { width: 80px; height: 50px; object-fit: cover; cursor: pointer; border-radius: 6px; border: 2px solid #2c2f4d; }
.screenshot-thumbnail:hover { transform: scale(1.1); border-color: #2962FF; }
.screenshot-cell { text-align: center; }
.modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); justify-content: center; align-items: center; }
.modal-content { max-width: 90%; max-height: 90%; border-radius: 8px; }
.close { position: absolute; top: 30px; right: 40px; color: #fff; font-size: 40px; cursor: pointer; }
.close:hover { color: #2962FF; }
</style>
</head>
<body>
<div class="container">
<header>
<h1>SOCIAL ENGINEERING DASHBOARD</h1>
<div class="subtitle">Phishing Sites & Human Attack Surface</div>
</header>

<div class="upload-section">
<h2>UPLOAD EXCEL DATA</h2>
<div class="upload-area" id="uploadArea">
<p>Click or drag & drop Excel file (.xlsx)</p>
<input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls">
</div>
<div id="fileInfo" class="file-info"></div>
<div id="errorMsg" class="error-msg"></div>
</div>

<div class="table-container" id="tableContainer">
<table>
<thead>
<tr>
<th>Site</th>
<th>Date</th>
<th>Sector Attacked</th>
<th>Attack Goal</th>
<th>Screenshot</th>
</tr>
</thead>
<tbody id="tableBody">
<tr><td colspan="5" style="text-align:center;color:#8b95a5;">No data loaded</td></tr>
</tbody>
</table>
</div>

<div id="imageModal" class="modal" onclick="closeModal()">
<span class="close">&times;</span>
<img class="modal-content" id="modalImage">
</div>

<script>
const uploadArea = document.getElementById('uploadArea');
const fileInput = document.getElementById('fileInput');
const fileInfo = document.getElementById('fileInfo');
const errorMsg = document.getElementById('errorMsg');
const tableContainer = document.getElementById('tableContainer');
const tableBody = document.getElementById('tableBody');

uploadArea.addEventListener('click', () => fileInput.click());
uploadArea.addEventListener('dragover', e => e.preventDefault());
uploadArea.addEventListener('drop', e => {
    e.preventDefault();
    fileInput.files = e.dataTransfer.files;
    handleFile(fileInput.files[0]);
});
fileInput.addEventListener('change', () => handleFile(fileInput.files[0]));

function handleFile(file) {
    if(!file) return;
    if(!file.name.endsWith('.xlsx') && !file.name.endsWith('.xls')) {
        errorMsg.textContent = 'Invalid file type. Use .xlsx or .xls';
        return;
    }
    errorMsg.textContent = '';
    fileInfo.textContent = `Loaded: ${file.name}`;

    const reader = new FileReader();
    reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];
        const json = XLSX.utils.sheet_to_json(worksheet, { header: ['Site','Date','Sector','Goal'], defval: '' });
        populateTable(json);
    };
    reader.readAsArrayBuffer(file);
}

function populateTable(data) {
    tableBody.innerHTML = '';
    data.forEach((row, index) => {
        const tr = document.createElement('tr');
        const imgPath = `https://raw.githubusercontent.com/nimeo1988/social-dasboard/main/images/${index+1}.png`;
        tr.innerHTML = `
            <td>${row.Site}</td>
            <td>${row.Date}</td>
            <td>${row.Sector}</td>
            <td>${row.Goal}</td>
            <td class="screenshot-cell"><img src="${imgPath}" class="screenshot-thumbnail" onclick="showImage('${imgPath}')"></td>
        `;
        tableBody.appendChild(tr);
    });
    tableContainer.style.display = 'block';
}

function showImage(src) {
    document.getElementById('modalImage').src = src;
    document.getElementById('imageModal').style.display = 'flex';
}

function closeModal() {
    document.getElementById('imageModal').style.display = 'none';
}
</script>
</div>
</body>
</html>
